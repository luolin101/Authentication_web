(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21f1adf8"],{"7c43":function(t,e,n){"use strict";n.r(e);var s=n("7a23");Object(s["M"])("data-v-2da623b6");var a={class:"login_box"},c=Object(s["n"])("div",{class:"login_close"},null,-1),o={class:"qrcode"},i=["src"],u={class:"empty"},r={class:"refresh"},l=Object(s["n"])("i",{class:"refresh_mask"},null,-1),h={class:"result"},b=["src"],d={class:"u_name"},f={class:"sub_title"},g=Object(s["n"])("p",{class:"sub_desc"},"扫码登录，更易、更快、更安全",-1);function p(t,e,n,p,j,m){var O=Object(s["S"])("router-link");return Object(s["J"])(),Object(s["m"])("div",a,[Object(s["q"])(O,{to:"/input"},{default:Object(s["hb"])((function(){return[c]})),_:1}),Object(s["n"])("div",o,[Object(s["ib"])(Object(s["n"])("img",{class:"img",src:j.imgURL,alt:"登录码"},null,8,i),[[s["eb"],1===j.state||3===j.state]]),Object(s["ib"])(Object(s["n"])("div",u,null,512),[[s["eb"],0===j.state]]),Object(s["ib"])(Object(s["n"])("div",r,[l,Object(s["n"])("i",{class:"refresh_icon",onClick:e[0]||(e[0]=function(){return m.getToken&&m.getToken.apply(m,arguments)})})],512),[[s["eb"],3===j.state]]),Object(s["ib"])(Object(s["n"])("div",h,[Object(s["n"])("img",{class:"u_avatar",src:j.userAvatar,alt:"用户头像"},null,8,b),Object(s["n"])("p",d,Object(s["W"])(j.userName),1)],512),[[s["eb"],2===j.state]]),Object(s["n"])("div",null,[Object(s["n"])("p",f,Object(s["W"])(j.tip),1),g])])])}Object(s["K"])();var j=n("b775"),m={name:"Auth",data:function(){return{state:0,count:30,tip:"正在获取登录码，请稍等",imgURL:"",authToken:"",userId:"",userAvatar:"",userName:"",tokenApi:"/auth/token",tokenImgApi:"/auth/img/",tokenInfoApi:"/auth/info/",userInfoApi:"/login/getUser"}},created:function(){this.getToken()},methods:{getToken:function(){var t=this;console.log("开始获取"),this.state=0,this.tip="正在获取登录码，请稍等",this.count=30,clearInterval(this.timeCount),j["a"].post(this.tokenApi).then((function(e){t.authToken=e.data,console.log(t.authToken,"token"),t.state=1,t.tip="请使用手机口令扫码登录",t.imgURL="http://localhost:9090"+t.tokenImgApi+e.data,console.log(t.imgURL),t.timeCount=setInterval(t.getTokenInfo,1e3)})).catch((function(e){console.log(e),t.getToken()}))},getTokenInfo:function(){var t=this;this.count--,0===this.count&&(this.state=3,this.tip="二维码已过期，请刷新"),this.count<-1e3&&(this.count=-1),j["a"].post(this.tokenInfoApi+this.authToken).then((function(e){var n=e.data;1===n.authState?(t.$message({message:"登录成功！",type:"success"}),clearInterval(t.timeCount)):2===n.authState?(t.userId=n.userId,t.getUserInfo(),t.state=2,t.tip="扫码成功，请在手机上确认"):3===n.authState&&(t.state=3,t.tip="二维码已过期，请刷新")})).catch((function(t){console.log(t)}))},getUserInfo:function(){var t=this;this.$ajax({method:"post",url:this.userInfoApi,data:this.qs.stringify({userId:this.userId})}).then((function(e){t.userName=e.data.data.userName,t.userAvatar=e.data.data.userAvatar,console.log(e.data.data)})).catch((function(t){console.log(t)}))}}},O=(n("cc52"),n("d959")),k=n.n(O);const v=k()(m,[["render",p],["__scopeId","data-v-2da623b6"]]);e["default"]=v},"8ed0":function(t,e,n){},cc52:function(t,e,n){"use strict";n("8ed0")}}]);
//# sourceMappingURL=chunk-21f1adf8.924b6bfb.js.map